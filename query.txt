<p>Query1: ONBOARDSTAFF CHECK PAST WORK</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="enumber1">
<input type="submit" value="search" name="query1"></p>
</form>


<p>Query2: ONBOARDSTAFF CHECK FUTURE WORK</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="enumber2">
<input type="submit" value="search" name="query2"></p>
</form>

<p>Query3: ONBOARDSTAFF CHECK AIRCRAFT</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="flightnumber">
<input type="text" name="flightdate">
<input type="submit" value="search" name="query3"></p>
</form>


<p>Query4: CUSTOMER CHECK ALL CLIENT</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="enumber3">
<input type="submit" value="search" name="query4"></p>
</form>


<p>Query6: CHECK FLIGHT TYPEI:FLGHT NO + DEPATURE DATE</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="fno1">
<input type="text" name="ddate1">
<input type="submit" value="search" name="query6"></p>
</form>

<p>Query7: CHECK FLIGHT TYPEII:DEPATRUE AIRPORT + ARRIVE AIRPORT+Depaturedate range</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="dpt">
<input type="text" name="apt">
<input type="text" name="dtime1">
<input type="text" name="dtime2">
<input type="submit" value="search" name="query7"></p>
</form>


<p>Query8: LOGIN CHECK:CUSTOMER SERVICES</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="eid1">
<input type="text" name="password1">
<input type="submit" value="search" name="query8"></p>
</form>

<p>Query9: LOGIN CHECK:ONBOARDSTAFF</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="eid2">
<input type="text" name="password2">
<input type="submit" value="search" name="query9"></p>
</form>

<p>Query10: LOGIN CHECK:MEMBER</p>
<form method="POST" action="database_init.php">  
<p><input type="text" name="eid3">
<input type="text" name="password3">
<input type="submit" value="search" name="query10"></p>
</form>







function printresultaircraft($result) { //prints results from a select statement
  //echo "<br> onboardstaff check the aircraft is used on given date and flight no:<br>";
  echo "<table>";
  echo "<tr><th>aircraft no</th></tr>";

  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row[0] ."</td></tr>"; 
  }
  echo "</table>";    
}

function printclient($result) { //prints results from a select statement
  //echo "<br> onboardstaff check the aircraft is used on given date and flight no:<br>";
  echo "<table>";
  echo "<tr><th> id name </th></tr>";

  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row[0] ."</td><td>".$row[1]."</td><td>"."<form method='POST',action='database_init.php'>
<p>
<select name='choose'>
<option value='counts'>TOTAL NUMBER OF TICKETS</option>
<option value='avgs'>AVG PRICE OF TICKETS</option>
<option value='mins'>MIN PRICE OF TICKETS</option>
<option value='maxs'>MAX PRICE OF TICKETS</option>
<option value='sums'>SUM PRICE OF TICKETS</option>
</p></form>"."</td><td>".
    "<form method='POST',action='database_init.php'>
        <p>
        <input type='hidden' name='userid2' size='6' value=$row[0]>
         <input type='hidden' name='name2' size='6' value=$row[1]>
         <input type='submit' value='check' name='query5'>
         </p>
         </form>"."</td></tr>"; 
  }
  echo "</table>"; 

}

function printflightinfo($result) { //prints results from a select statement
 echo "<br> FLIGHT INFO <br>";
  echo "<table>";
  //echo "<tr><th>USERID</th><th>NAME</th></tr>";
  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row[0] ."</td><td>" . $row[1]."</td></td>".
    $row[2]."</td></td>".
    $row[3]."</td></td>".
    $row[4]."</td></td>".
    $row[5]."</td></td>".
    $row[6]."</td></td>".
    $row[7]."</td></td>".
    $row[8]."</td></td>".
    $row[9]."</td></td>".$row[10]."</td></td>"."<form method='POST',action='oracle-test.php'>
        <p><input type='hidden' name='flightNo' size='6' value=$row[0]>
         <input type='hidden' name='departureDate' size='6' value=$row[1]>
     <input type='submit' name='purchase' size='6' value='purchase'>
         </p>
         </form>"."</td></tr>"; 
  }
  echo "</table>";    
}

function printclientinfo($result) { //prints results from a select statement
 // echo "<br>Got data from table onboardstaff:<br>";
  echo "<table>";
  echo "<tr><th>ID</th><th>Name</th><th>password</th></tr>";

  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row[0] . "</td><td>" . $row[1] ."</td><td>". $row[2] ."</td><td>" . $row[3]."</td><td>" . $row[4]."</td><td>" . $row[5]."</td><td>" . $row[6]."</td></tr>" ; //or just use "echo $row[0]"
  }
  echo "</table>";

}

function printclientinfo2($result) { //prints results from a select statement
 // echo "<br>Got data from table onboardstaff:<br>";
  echo "<table>";
  echo "<tr><th>COUNT</th><th>AVG</th><th>MAX</th><th>MIN</th><th>SUM</th></tr>";

  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row[0] . "</td><td>" . $row[1] . "</td><td>" . $row[2] . "</td><td>" . $row[3] . "</td><td>" . $row[4] ."</td></tr>" ; //or just use "echo $row[0]"
  }
  echo "</table>";

}
 
  function printResultwinew($result) { //prints results from a select statement
  //echo "<br>Got data from table workin:<br>";
  echo "<table>";
  echo "<tr><th>enumber</th><th>name</th><th>flightnumber</th><th>date</th></tr>";

  while ($row = OCI_Fetch_Array($result, OCI_BOTH)) {
    echo "<tr><td>" . $row["EMPLOYNUMBER"] . "</td><td>" . $row["NAME"] ."</td><td>". $row["FLIGHTNUMBER"] ."</td><td>". $row["DATE1"]. "</td></tr>"; //or just use "echo $row[0]" 
  }
  echo "</table>";
}

function printclientinfo3($result1,$result2) { //prints results from a select statement
 // echo "<br>Got data from table onboardstaff:<br>";
  echo "<table>";
  echo "<tr><th>ID</th><th>Name</th><th>password</th></tr>";

  while (($row1 = OCI_Fetch_Array($result1, OCI_BOTH))&&($row2 = OCI_Fetch_Array($result2, OCI_BOTH))) {
    echo "<tr><td>" . $row1[0] . "</td><td>" . $row1[1] ."</td><td>". $row1[2] ."</td><td>" . $row1[3]."</td><td>" . $row1[4]."</td><td>" . $row1[5]."</td><td>" . $row1[6]."</td><td>". $row2[0].
    "</td></tr>" ; //or just use "echo $row[0]"
  }
  echo "</table>";

}



 if(array_key_exists('query1', $_POST)){
 $number1=$_POST['enumber1'];
        executePlainSQL("ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YYYY HH24:MI:SS'");
  $result = executePlainSQL("
           select workin.employNumber as employnumber,onboardstaff.name as name,workin.flightNumber as flightnumber,workin.dateorg as date1
             from workin,onboardstaff,Flight_Use
             where workin.employNumber=$number1 and 
            workin.employNumber=onboardstaff.employNumber and Flight_Use.departureDate=workin.dateorg and Flight_Use.ETD<='01-APR-2017 00:00:00'  ");
         printResultwinew($result);
  }

else

  if(array_key_exists('query2', $_POST)){
 $number1=$_POST['enumber2'];
        executePlainSQL("ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YYYY HH24:MI:SS'");
  $result = executePlainSQL("
           select workin.employNumber as employnumber,onboardstaff.name as name,workin.flightNumber as flightnumber,workin.dateorg as date1
             from workin,onboardstaff,Flight_Use
             where workin.employNumber=$number1 and 
            workin.employNumber=onboardstaff.employNumber and Flight_Use.departureDate=workin.dateorg and Flight_Use.ETD>'01-APR-2017 00:00:00'  ");
         printResultwinew($result);
  }
else
    if(array_key_exists('query3', $_POST)){
 $fno=$_POST['flightnumber'];
 $date=$_POST['flightdate'];  
  $result = executePlainSQL("
                  select Flight_Use.aircraftSerialNo 
                  from Flight_Use 
                  where Flight_Use.flightNumber='$fno' and Flight_Use.departureDate='$date'");
         printresultaircraft($result);
  }
  else
        if(array_key_exists('query4', $_POST)){
 $eno=$_POST['enumber3'];
  $result = executePlainSQL("
                  select member_serve.userid as userid, member_serve.name as name 
                  from member_serve
                  where member_serve.employNumber=$eno");
         printclient($result);
  }
else
   if(array_key_exists('query5', $_POST)){

 $userid=$_POST['userid2'];
$name=$_POST['name2'];
         
      $result=executePlainSQL("select member_serve.userid as userid, member_serve.gender as gender, member_serve.emailAddress
            as email,member_serve.passportNum as passport, member_serve.nationality as nationality, 
            member_serve.dob as dob, member_serve.name as name
            from member_serve
            where member_serve.userid='$userid'");

     // printclientinfo($result);
   $result1=executePlainSQL("
         select COUNT(ticket_has.ticketID) as numtickets
         from member_serve,ticket_has
         where member_serve.userid='$userid' and 
         member_serve.passportNum=ticket_has.passportNumber");  

   $result2=executePlainSQL("
         select AVG(ticket_has.ticketPrice) as avgs
         from member_serve,ticket_has
         where member_serve.userid='$userid' and 
         member_serve.passportNum=ticket_has.passportNumber");  

$result3=executePlainSQL("
         select MIN(ticket_has.ticketPrice) as mins
         from member_serve,ticket_has
         where member_serve.userid='$userid' and 
         member_serve.passportNum=ticket_has.passportNumber");  

$result4=executePlainSQL("
         select  MAX(ticket_has.ticketPrice) as maxs
         from member_serve,ticket_has
         where member_serve.userid='$userid' and 
         member_serve.passportNum=ticket_has.passportNumber");  

$result5=executePlainSQL("
         select SUM(ticket_has.ticketPrice) as sums
         from member_serve,ticket_has
         where member_serve.userid='$userid' and 
         member_serve.passportNum=ticket_has.passportNumber");  

if(isset($_POST['choose'])){
    $choose = $_POST['choose'];
    switch ($choose) {
        case 'counts':
            printclientinfo3($result,$result1);
            break;
        case 'avgs':
            printclientinfo3($result,$result2);
            break;
        case 'mins':
             printclientinfo3($result,$result3);
            break;
        case 'maxs':
            printclientinfo3($result,$result4);
            break;
        case 'sums':
            printclientinfo3($result,$result5);
            break;
        
    }
}
     
  }
else
   if(array_key_exists('query6', $_POST)){

 executePlainSQL("ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YYYY HH24:MI:SS'");
 $flightno=$_POST['fno1'];
 $ddate=$_POST['ddate1'];     
      $result=executePlainSQL("select * 
        from Flight_Use
  where Flight_Use.flightNumber='$flightno' and Flight_Use.departureDate='$ddate'");
       printflightinfo($result);

  }
  else
     if(array_key_exists('query7', $_POST)){

       executePlainSQL("ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YYYY HH24:MI:SS'");

$dairport=$_POST['dpt'];
$aairport=$_POST['apt'];
$date1=$_POST['dtime1']; 
$timestamp1= executePlainSQL("SELECT TO_TIMESTAMP('$date1','YYYY-MON-DD') FROM dual");
//$timestamp1=strtotime($date1);
$date2=$_POST['dtime2'];
$timestamp2=executePlainSQL("SELECT TO_TIMESTAMP('$date2','YYYY-MON-DD') FROM dual" );
//$timestamp2=strtotime($date2);
$time1 = OCI_Fetch_Array($timestamp1, OCI_BOTH);
$time2 = OCI_Fetch_Array($timestamp2, OCI_BOTH);

//echo $timestamp1;
//echo $time1[0];
//echo $time2[0];

  executePlainSQL("ALTER SESSION SET NLS_TIMESTAMP_FORMAT='DD-MON-YYYY HH24:MI:SS'");
      $result=executePlainSQL("
        select * 
        from Flight_Use
        where Flight_Use.departureAirport='$dairport' and Flight_Use.arrivalAirport='$aairport' and 
Flight_Use.ETD>= '$time1[0]' and Flight_Use.ETD<= '$time2[0]'");
      echo OCI_Fetch_Array($result, OCI_BOTH)[0];
       printflightinfo($result);

  }

  else
if(array_key_exists('query8', $_POST))
  {
 $eid=$_POST['eid1'];
$password=$_POST['password1'];
if(
executePlainSQL("
select case when count(*) > 0 then 1 else 0 end 
 from customerservice 
 where employNumber='$eid' and password='$password'")==0)
{echo"wrong!";}
else  
{echo"correct!";}
  }
  else
    if(array_key_exists('query9', $_POST)){

 $eid=$_POST['eid2'];
$password=$_POST['password2'];
          if(
executePlainSQL("
select case when count(*) > 0 then 1 else 0 end 
 from onboardstaff 
 where employNumber='$eid' and password='$password'")==0)
{echo"wrong!";}
else  
{echo"correct!";}


  }else
    if(array_key_exists('query10', $_POST)){
 $eid=$_POST['eid3'];
$password=$_POST['password3'];
    if(
executePlainSQL("
select case when count(*) > 0 then 1 else 0 end 
 from member_serve
 where userid='$eid' and password='$password'")==0)
echo"wrong!";
else  
echo"correct!";
  }